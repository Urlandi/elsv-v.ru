+++
title = "Поиск по базе данных RIPE"
+++


[RIPE NCC](http://www.ripe.net) - европейский региональный егистратор Интернет. Производит распределение и контроль за такими ресурсами как IP адреса, номера автономных систем и другими связанными объектами. Выполняет организационную и техническую деятельность направленную на устойчивость сети в целом. Функционирует как собрание независимых локальных регистраторов LIR (интернет компании, провайдеры), для которых предоставляет различные сервисы по контролю над теми ресурсами которые получены ими в управление. 

Все распределяемые ресурсы находятся в базе данных [RIPEDB](http://ripe.net/whois) доступ к которой возможен различными способами. Помимо просто получения данных, интерфейс RIPEDB позволяет модифицировать находящиеся в пользовании организации объекты, а также предоставляет другие возможности, например, сервис [геолокации](https://apps.db.ripe.net/search/geolocation-finder.html).


1. [Whois]({{<ref "#whois">}})
 1. [AUT-NUM]({{<ref "#aut-num">}})
 1. [ORGANISATION]({{<ref "#organisation">}})
 1. [INETNUM]({{<ref "#inetnum">}})
1. [Полнотекстовый поиск]({{<ref "#fullsearch">}})
1. [FTP]({{<ref "#ftp">}})


## Whois {#whois}

Основной интерфейс запросов к данным агрегируемых в базе это интерфейс whois, доступный в классическом варианте по адресу `whois://whois.ripe.net:43` и через web интерфейс http://ripe.net/whois. Существует ограничение на количество одновременно возвращаемых объектов: не более 100 на запрос - также существуют и другие [ограничения](http://www.ripe.net/data-tools/support/documentation/aup) и [соглашения](http://www.ripe.net/data-tools/support/documentation/terms), направленные в первую очередь на защиту приватной информации которая содержится в хранимых объектах. Результаты поиска в web интерфейсе можно забрать в форматах XML и JSON.

Поиск по данным с использованием запросов выполняется только по заголовкам объектов - прямой поиск, и по полям связывающим объекты - обратный поиск. Список возможных объектов [не очень длинный](https://www.ripe.net/data-tools/support/documentation/ripe-database-query-reference-manual#LinkTarget_3010). Обратный поиск содержит практически тот же самый список, с поправкой на значимые поля внутри описания объекта. Дополнительно к запросу, помимо имени объекта можно добавлять [параметры](https://www.ripe.net/data-tools/support/documentation/queries-quick-ref), которые в основном сокращают выдачу конкретизируя запрос. По сравнению с web интерфейсом консольный вариант чуть больше параметров упрощающих выдачу и пакетную обработку. При использовании web интерфейса все параметры присутствуют во вкладках под строкой поиска, в виде полей выбора. Кроме собственных данных RIPEDB позволяет производить поиск данных других регистраторов: параметр `source` в web интерфейсе.

Рассмотрим некоторые объекты и полезную информацию которую можно из них почерпнуть:

### AUT-NUM {#aut-num}

Объект определяющий номер автономной системы. Для поиска необходимо снабжать приставкой AS, например, AS64500. Как правило это корневой объект организации, в полях которого помимо фиксированной информации, часто в качестве комментариев заносится дополнительная необходимая информация: адреса и телефоны экстренной связи, организации с которыми установлена связь, используемые фильтры и другие технические особенности подключения и использования.

```
aut-num:        AS31133
as-name:        MF-MGSM-AS
descr:          OJSC MegaFon
org:            ORG-OM1-RIPE
remarks:        
remarks:        --- Upstreams ---
remarks:        
import:         from AS1299 accept ANY
export:         to AS1299 announce AS-MF-MGSM

>< ------------------------------ ><

remarks:        --- AMS-IX ---
remarks:        
import:         from AS1200 accept AS1200
export:         to AS1200 announce AS-MF-MGSM

>< ------------------------------ ><

remarks:        --- DE-CIX ---
remarks:        
import:         from AS6695 accept AS-DECIX
export:         to AS6695 announce AS-MF-MGSM

>< ------------------------------ ><

remarks:        --- MSK-IX ---
remarks:        
import:         from AS43832 accept AS-NS5_RIPN_NET
export:         to AS43832 announce AS-MF-MGSM

>< ------------------------------ ><

remarks:        +----------------------------------------------------------+
remarks:        | Backup Community
remarks:        +----------------------------------------------------------+
remarks:        |
remarks:        | 31133:240 - Set local preference 240 (backup)
remarks:        | 31133:250 - Set local preference 250 (like an Upstream)
remarks:        | 31133:270 - Set local preference 270 (like a Peer)
remarks:        |
remarks:        | Default local preference for Customer is 300

>< ------------------------------ ><

remarks:        | Contacts
remarks:        +----------------------------------------------------------+
remarks:        | Web Site http://www.megafon.ru
remarks:        | Looking Glass http://lg.megafon.ru

>< ------------------------------ ><

admin-c:        MVLG-RIPE
tech-c:         MVLG-RIPE
mnt-by:         RIPE-NCC-ENd-MNT
mnt-routes:     MEGAFON-RIPE-MNT
mnt-routes:     MGSM-MNT
mnt-by:         MGSM-MNT
```

Стандартными полями (эти поля можно использовать для обратного поиска), как можно увидеть в блоке выше, являются:
 * `org` - ссылка на объект определяющий организацию которой принадлежит данный объект;
 * `tech-c, admin-c` - объекты определяющие администраторов или группы администраторов которые отвечают за функционирование связанный с объектом ресурсов. Содержат имя или описание, и контактные данные;
 * `mnt-*` - объекты созданные для защиты изменения других объектов, содержат данные аутентификации, упрощённо - учётная запись для доступа к работе с базой. Могут применяться выборочно к объектам определённого типа. Если выполнять обратный поиск по этим полям, результатом будут все объекты которые, соответственно, принадлежат заданной организации, либо обслуживаются конкретными администраторами, либо защищены одной учётной записью.
 * `remarks, *name, descr` - текстовые поля в большинстве случаев произвольного содержания, в которых указывается поясняющая и дополняющая информация. В частности, может описываться назначение использования того или иного блока адресов.

Поля `import`, `export` описывают соседские отношения с другими автономными системами. В них, как правило, указываются номер автономной системы с которой установлена связь и правила которые к ней применяются: какие адреса передаются, какие принимаются, какие маршрутные приоритеты у принятой информации.

### ORGANISATION {#organisation}

В этом объекте раскрывается контактная информация с организацией хозяином записи. Сам объект выступает обычно в роли ссылки в других объектах, где необходимо явно указывать принадлежность. Контактная информация как правило максимально подробна и помимо экстренных данных которые могут присутствовать в объектах `aut-num`, содержит в себе юридический/фактический адрес, телефоны, факсы, принадлежность к той или иной стране, вид деятельности.

### INETNUM {#inetnum}

Описывает блоки IP адресов выданных или назначенных в управление. Данный объект описывает связку: организация и блок IP, если так можно выразиться, с административной точки зрения. Фактически где эти адреса будут маршрутизироваться и через какую автономную систему будут видны описывается в объекте `route`, который связывает блок адресов и автономную систему. Дополнительную информацию о блоке адресов может дать объект `domain`, выполняющий привязку к DNS серверу для разрешения обратной зоны.

При поиске в базе данных существует специальная опция `-d`, которая свяжет все эти объекты вместе если в запросе будет указан IP адрес. То есть результатом будут все объекты `inetnum`, `route`, `domain` в которых встретился заданный при поиске адрес.

## Полнотекстовый поиск {#fullsearch}

Помимо запросов whois, из web интерфейса возможен [полнотекстовый поиск](https://apps.db.ripe.net/search/full-text.html) в простом (по умолчанию) и расширенном режимах. В расширенном режиме поиск конкретизируется по определённым типам объектов и типам полей внутри объектов. Если строка запроса состоит из нескольких частей, то способ обработки отдельных частей строки задаётся переключателями: совпадает всё, совпадает любое и точное совпадение. 

Результатом поиска является список ссылок на объекты в полях которых встречается заданное сочетание. Справа от результатов поиска будет меню, которое позволяет выбрать только конкретные типы объектов для отображения. Количество возвращаемых значений не ограничивается 100, например, при строке поиска `Volgograd` результат содержит больше 200 страниц, где каждая страница представлена в таком виде:

```
domain: 116.183.62.in-addr.arpa 
descr=Volgograd"" 

domain: 2.22.81.in-addr.arpa 
descr=Reverse delegation for Sprint Net, Volgograd"" 

domain: 3.22.81.in-addr.arpa 
descr=Reverse delegation for Sprint Net, Volgograd"" 

domain: 1.22.81.in-addr.arpa 
descr=Reverse delegation for Sprintnet, Volgograd"" 

domain: 178.250.80.in-addr.arpa 
descr=Volgograd"" State Univercity 

domain: 1.155.178.in-addr.arpa 
nserver=ns2.mks-volgograd"".ru 
```

## FTP {#ftp}

К содержимому базы данных есть прямой доступ (за исключением полей с контактной информацией, которые будут скрыты) если обратиться к FTP ftp://ftp.ripe.net/ripe/dbase/, где хранятся архивы с содержимым всех объектов вместе, а также в  разделённом виде по типам объектов в каталоге `split`. Таким способом, при необходимости, возможно производить обработку данных более гибко. Правила и соглашения при использовании этих архивов такие же как и при любом другом доступе.

----
 - http://subnets.ru/blog/?p=24