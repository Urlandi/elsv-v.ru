+++
title = "Looking glass"
+++

Сервис позволяющий удалённо увидеть результаты выполнения сетевых команд на ключевых устройствах сети. Обычно это команды `traceroute`, `ping` и вывод данных состояния [BGP](/wiki/guides/bgp/): полученные и переданные префиксы, соседние маршрутизаторы, таблица маршрутизации. Доступ к данному сервису может, и как правило, предоставляется магистральными провайдерами и крупными интернет площадками, например, https://lg.ip.rt.ru или http://lg.vk.com. Если добавить `lg.` к основному доменному имени используемому оператором, есть вероятность найти там этот сервис. Используя данный ресурс можно понять как видно твоё устройство с принимающей стороны, а не строить версии только на собственных данных[^fn:1].

Одна из распространённых реализаций это [looking glass от version6.net](https://github.com/version6net/lg), встречается у многих операторов.

![version6 looging-glass](/static/wiki/guides/screen3.png)

В правой части находится выпадающий список с узлами для которых можно выполнить команды, в центре поле для ввода параметров. Конечно внешний вид и реализация может быть произвольной, но как правило доступны следующие функции:

 1. [ping](/wiki/guides/ping/) и [traceroute](/wiki/guides/traceroute/)
 2. `bgp summary` - [Общая информация BGP]({{<ref "#bgpsummary">}})
 3. `bgp` - [Таблица маршрутизации BGP]({{<ref "#bgp">}})
 4. `bgp advertised-routes` - [Объявляемые маршруты соседям BGP]({{<ref "#bgpadvertised">}})


## BGP SUMMARY {#bgpsummary}

Не требует ввода параметров, показывает общую информацию о настройке BGP на данном устройстве: номер локальной автономной системы, количество маршрутов, версию таблицы, таймеры обновления, занимаемую память. Далее следует таблица с перечислением всех установленных связей с другими маршрутизаторами. Как правило в каждой строчке будет отображён IP адрес соседнего маршрутизатора, номер его автономной системы, версия протокола, время работы связи.

В выводе могут присутствовать активные ссылки. Для номеров автономных систем, скорее всего это будут ссылки на информацию `whois` на сайте регистратора. Для счётчиков префиксов или маршрутов, будет ссылка на запрос `bgp advertised-routes` или к `bgp`. Для адресов соседних маршрутизаторов ссылка на подробный вывод информации об установленной связи `show bgp neighbor`.

![BGP summary](/static/wiki/guides/screen4.png)

На этом изображении видно что номер локальной автономной системы AS6539. Первый сосед в таблице имеет IP адрес 66.59.190.219, используется BGP версии 4, от него получен 121 префикс.

## BGP {#bgp}

В качестве параметра следует ввести интересующий адрес. Лучше всего ввести сеть с указанием маски, тогда вывод может быть более подробным, в частности, будут показаны альтернативные маршруты, а не только используемый. Также в выводе может присутствовать сопутствующая [маршрутная информация](/wiki/guides/bgp/): переданные строчки `community`, вес, метрика, `localpref`. Также в выводе могут присутствовать активные ссылки связывающие данные результаты с другими запросами или уточняющие информацию.

![BGP route](/static/wiki/guides/screen6.png)

Лучший маршрут отмечен другим цветом. Показаны параметры `localpref`=140, `wight`=60, видно принятые строчки `community` с добавленными текстовыми комментариями.

## BGP ADVERTISED-ROUTES {#bgpadvertised}

В параметре следует указать IP адрес соседнего маршрутизатора. В результате выполнения вывод будет представлять собой таблицу, с указанием всех адресов которые данный маршрутизатор передаёт указанному соседнему. Пример, данной команды можно увидеть в [Каталоге](/dir/) - оператор **Билайн**, [используемые адреса](http://lg.corbina.net/lg.cgi?query=bgp&protocol=IPv4&addr=neighbors+62.141.100.113+advertised-routes&router=ang17-bb.vlg).

----
[^fn:1]: Классическое - от меня пули ушли, проблемы на принимающей стороне